# Implementation Plan: Site Officiel Trait d'Union Studio

## Overview

Ce plan d'implémentation détaille les tâches pour construire le site vitrine TUS avec Django, HTMX et Tailwind CSS. Les tâches sont organisées de manière incrémentale, chaque étape construisant sur la précédente. Les tests property-based valident les propriétés de correction définies dans le design.

**Stack** : Python 3.11+ / Django 5.x / HTMX / Tailwind CSS / pytest / hypothesis

---

## Tasks

- [ ] 1. Initialisation du projet Django et configuration de base
  - [ ] 1.1 Créer le projet Django avec structure de settings split (base, development, production)
    - Initialiser le projet `tus_website` avec `django-admin startproject`
    - Configurer les settings split dans `config/settings/`
    - Définir les variables d'environnement (SECRET_KEY, DEBUG, DATABASE_URL)
    - _Requirements: 15.1, 15.4_
  - [ ] 1.2 Configurer Tailwind CSS avec les variables du Design System TUS
    - Installer django-tailwind et configurer le thème
    - Définir les couleurs officielles (#07080A, #F6F7FB, #0B2DFF)
    - Configurer les fonts Space Grotesk et Inter via Google Fonts
    - Définir les animations (150-280ms, cubic-bezier)
    - _Requirements: 8.1, 8.3, 8.6, 8.7_
  - [ ] 1.3 Créer le template de base avec navbar et footer
    - Créer `templates/base.html` avec structure HTML5 sémantique
    - Implémenter la navbar responsive avec logo TUS
    - Implémenter le footer avec liens rapides et pages légales
    - Configurer les preconnect pour Google Fonts
    - _Requirements: 7.1, 7.2, 9.1, 10.3_
  - [ ] 1.4 Écrire les tests unitaires pour la configuration de base
    - Tester que les settings sont correctement chargés
    - Tester que les URLs de base répondent
    - _Requirements: 15.1_

- [ ] 2. Checkpoint - Vérifier la configuration de base
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 3. Implémentation de l'app Pages (pages statiques)
  - [ ] 3.1 Créer l'app `pages` avec les vues pour Accueil, Services, Méthode
    - Créer les vues TemplateView pour chaque page
    - Configurer les URLs dans `apps/pages/urls.py`
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3, 4.1, 4.2_
  - [ ] 3.2 Implémenter le template de la page Accueil
    - Afficher le slogan officiel
    - Créer les 3 blocs d'aperçu des offres (Vitrine, Commerce, Système)
    - Ajouter la section preuves de qualité
    - Implémenter les CTAs vers Services, Méthode, Contact, Ressources
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_
  - [ ] 3.3 Implémenter le template de la page Services
    - Créer les 3 blocs d'offre détaillés
    - Afficher "Ce que vous recevez" et options pour chaque offre
    - Ajouter les CTAs "Demander une estimation" et "Nous écrire"
    - _Requirements: 2.1, 2.2, 2.3, 2.4_
  - [ ] 3.4 Implémenter le template de la page Méthode
    - Afficher le processus en 5 étapes (Cadrage, Conception, Développement, QA, Déploiement)
    - Décrire les livrables pour chaque étape
    - Ajouter les CTAs vers Ressources et Contact
    - _Requirements: 4.1, 4.2, 4.3, 4.4_
  - [ ] 3.5 Écrire les tests unitaires pour les pages statiques
    - Tester le rendu de chaque page
    - Vérifier la présence des éléments clés (slogan, CTAs)
    - _Requirements: 1.1, 2.1, 4.1_

- [ ] 4. Implémentation de l'app Portfolio (Réalisations)
  - [ ] 4.1 Créer l'app `portfolio` avec le modèle Project
    - Définir le modèle Project avec tous les champs (title, slug, project_type, objective, solution, result, etc.)
    - Créer le modèle ProjectImage pour la galerie
    - Configurer l'admin Django pour la gestion des projets
    - _Requirements: 3.1, 3.2_
  - [ ] 4.2 Implémenter les vues liste et détail des projets
    - Créer ProjectListView avec filtrage par type
    - Créer ProjectDetailView pour les détails d'un projet
    - Configurer les URLs avec slug
    - _Requirements: 3.1, 3.3, 3.4_
  - [ ] 4.3 Implémenter le filtrage HTMX pour les réalisations
    - Créer le partial `portfolio/_project_list.html`
    - Implémenter les boutons de filtre avec hx-get
    - Configurer la vue pour retourner le partial si requête HTMX
    - _Requirements: 3.3_
  - [ ] 4.4 Écrire le test property-based pour le filtrage portfolio
    - **Property 2: Filtrage portfolio par type**
    - Générer des projets avec types aléatoires
    - Vérifier que le filtre retourne uniquement les projets du type sélectionné
    - **Validates: Requirements 3.3**
  - [ ] 4.5 Écrire le test property-based pour les fiches projet
    - **Property 1: Fiche projet complète**
    - Générer des projets aléatoires
    - Vérifier que chaque fiche contient objectif, solution, résultat
    - **Validates: Requirements 3.2**

- [ ] 5. Checkpoint - Vérifier l'app Portfolio
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 6. Implémentation de l'app Leads (Formulaire de contact)
  - [ ] 6.1 Créer l'app `leads` avec le modèle Lead
    - Définir le modèle Lead avec tous les champs
    - Configurer les choix pour project_type et budget
    - Ajouter les champs honeypot et ip_address pour anti-spam
    - Configurer l'admin Django
    - _Requirements: 5.1, 5.3_
  - [ ] 6.2 Implémenter le formulaire ContactForm avec validation
    - Créer le formulaire Django avec tous les champs
    - Implémenter la validation du honeypot
    - Implémenter la validation des fichiers uploadés (type, taille)
    - Ajouter les messages d'erreur localisés
    - _Requirements: 5.1, 5.6, 5.8_
  - [ ] 6.3 Implémenter la vue ContactView et le template
    - Créer la vue FormView avec gestion du succès
    - Implémenter le template avec design TUS
    - Ajouter les focus rings bleus et messages d'erreur
    - Afficher le délai de réponse (24-48h)
    - _Requirements: 5.1, 5.6, 13.4_
  - [ ] 6.4 Implémenter l'adaptation dynamique des champs via HTMX
    - Créer le partial `leads/_dynamic_fields.html`
    - Implémenter DynamicFieldsView pour retourner les champs selon le type
    - Configurer hx-get sur le select project_type
    - _Requirements: 5.2_
  - [ ] 6.5 Écrire le test property-based pour l'adaptation dynamique
    - **Property 3: Adaptation dynamique du formulaire**
    - Générer des types de projet aléatoires
    - Vérifier que les champs retournés correspondent au type
    - **Validates: Requirements 5.2**
  - [ ] 6.6 Écrire le test property-based pour la validation formulaire
    - **Property 4: Validation formulaire avec messages d'erreur**
    - Générer des données invalides (email malformé, message court)
    - Vérifier que les messages d'erreur appropriés sont affichés
    - **Validates: Requirements 5.6**
  - [ ] 6.7 Écrire le test property-based pour la validation upload
    - **Property 6: Validation upload fichiers**
    - Générer des fichiers avec types et tailles variés
    - Vérifier que seuls les fichiers conformes sont acceptés
    - **Validates: Requirements 5.8, 12.5**

- [ ] 7. Implémentation de la protection anti-spam
  - [ ] 7.1 Implémenter le middleware RateLimitMiddleware
    - Créer le middleware avec limite de 5 soumissions/heure/IP
    - Stocker les compteurs en cache Django
    - Logger les tentatives bloquées
    - _Requirements: 5.7, 12.4_
  - [ ] 7.2 Intégrer le honeypot dans le formulaire
    - Ajouter le champ honeypot caché via CSS
    - Valider que le champ est vide côté serveur
    - Rejeter silencieusement si rempli
    - _Requirements: 5.7_
  - [ ] 7.3 Écrire le test property-based pour l'anti-spam
    - **Property 5: Protection anti-spam honeypot et rate limiting**
    - Générer des soumissions avec honeypot rempli ou rate limit dépassé
    - Vérifier que les soumissions sont rejetées sans créer de Lead
    - **Validates: Requirements 5.7, 12.4**

- [ ] 8. Implémentation du service Email
  - [ ] 8.1 Créer le service EmailService
    - Implémenter send_confirmation_email avec template HTML
    - Implémenter send_admin_notification avec tous les détails
    - Configurer le backend email (console en dev, SMTP en prod)
    - _Requirements: 5.4, 5.5_
  - [ ] 8.2 Intégrer l'envoi d'emails dans ContactView
    - Appeler EmailService.send_confirmation_email après sauvegarde
    - Appeler EmailService.send_admin_notification
    - Gérer les erreurs d'envoi gracieusement
    - _Requirements: 5.4, 5.5_
  - [ ] 8.3 Écrire le test property-based pour les emails
    - **Property 17: Emails confirmation et notification round-trip**
    - Générer des leads valides aléatoires
    - Vérifier que les deux emails sont envoyés avec le bon contenu
    - **Validates: Requirements 5.4, 5.5**

- [ ] 9. Checkpoint - Vérifier l'app Leads complète
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 10. Implémentation de l'app Resources (Téléchargements)
  - [ ] 10.1 Créer l'app `resources` avec les vues
    - Créer ResourcesView pour la page de liste
    - Créer DownloadView pour servir les fichiers PDF
    - Configurer les URLs
    - _Requirements: 6.1, 6.2, 6.3_
  - [ ] 10.2 Implémenter le template de la page Ressources
    - Afficher les deux ressources avec descriptions
    - Ajouter les CTAs de téléchargement
    - _Requirements: 6.1, 6.2, 6.4_
  - [ ] 10.3 Créer les fichiers PDF placeholder
    - Créer checklist-projet-web-premium.pdf
    - Créer modele-cahier-des-charges.pdf
    - Placer dans static/resources/
    - _Requirements: 6.1, 6.2_
  - [ ] 10.4 Écrire le test property-based pour les téléchargements
    - **Property 7: Téléchargement ressources**
    - Générer des identifiants de ressource valides et invalides
    - Vérifier que les fichiers valides sont servis correctement
    - **Validates: Requirements 6.3**

- [ ] 11. Implémentation des pages légales
  - [ ] 11.1 Créer les templates pour Mentions Légales et Politique de Confidentialité
    - Créer `pages/legal.html` et `pages/privacy.html`
    - Ajouter le contenu légal de base
    - Lier depuis le footer
    - _Requirements: 13.1, 13.2_
  - [ ] 11.2 Implémenter le bandeau de consentement cookies (optionnel)
    - Créer le composant bandeau avec HTMX
    - Stocker le consentement en localStorage
    - _Requirements: 13.3_

- [ ] 12. Implémentation SEO et Performance
  - [ ] 12.1 Configurer les meta tags par page
    - Créer le block `{% block meta %}` dans base.html
    - Définir title et description uniques par page
    - Ajouter les balises OpenGraph
    - _Requirements: 11.1, 11.4_
  - [ ] 12.2 Générer sitemap.xml et robots.txt
    - Configurer django.contrib.sitemaps
    - Créer le fichier robots.txt statique
    - _Requirements: 11.2, 11.3_
  - [ ] 12.3 Ajouter les données structurées Schema.org
    - Implémenter JSON-LD pour Organisation
    - Ajouter dans le template base.html
    - _Requirements: 11.5_
  - [ ] 12.4 Implémenter le lazy loading des images
    - Ajouter loading="lazy" sur toutes les images de contenu
    - Exclure les images above-the-fold
    - _Requirements: 10.2_
  - [ ] 12.5 Écrire le test property-based pour les meta tags SEO
    - **Property 11: SEO meta tags par page**
    - Parcourir toutes les pages du site
    - Vérifier la présence et l'unicité des meta tags
    - **Validates: Requirements 11.1, 11.4**
  - [ ] 12.6 Écrire le test property-based pour les URLs propres
    - **Property 9: URLs propres et lisibles**
    - Parcourir toutes les URLs du site
    - Vérifier le format (alphanumériques, tirets, pas de query strings)
    - **Validates: Requirements 7.5**
  - [ ] 12.7 Écrire le test property-based pour le lazy loading
    - **Property 10: Lazy loading images**
    - Parcourir toutes les images de contenu
    - Vérifier la présence de loading="lazy"
    - **Validates: Requirements 10.2**

- [ ] 13. Checkpoint - Vérifier SEO et Performance
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 14. Implémentation Sécurité
  - [ ] 14.1 Configurer les headers de sécurité
    - Créer SecurityHeadersMiddleware
    - Ajouter X-Frame-Options, X-Content-Type-Options, X-XSS-Protection
    - Configurer HSTS pour la production
    - _Requirements: 12.3_
  - [ ] 14.2 Vérifier la protection CSRF
    - S'assurer que {% csrf_token %} est dans tous les formulaires
    - Configurer CSRF_COOKIE_SECURE en production
    - _Requirements: 12.1_
  - [ ] 14.3 Configurer les sessions sécurisées
    - Définir SESSION_COOKIE_SECURE, SESSION_COOKIE_HTTPONLY
    - Configurer SESSION_COOKIE_AGE
    - _Requirements: 12.2_
  - [ ] 14.4 Écrire le test property-based pour la protection CSRF
    - **Property 12: Protection CSRF sur formulaires**
    - Tester les soumissions avec et sans token CSRF
    - Vérifier que les requêtes sans token sont rejetées
    - **Validates: Requirements 12.1**
  - [ ] 14.5 Écrire le test property-based pour les headers de sécurité
    - **Property 13: Headers de sécurité HTTP**
    - Parcourir plusieurs réponses HTTP
    - Vérifier la présence de tous les headers requis
    - **Validates: Requirements 12.3**

- [ ] 15. Implémentation Accessibilité
  - [ ] 15.1 Implémenter le focus visible pour navigation clavier
    - Définir les styles :focus-visible dans Tailwind
    - S'assurer que tous les éléments interactifs ont un focus visible
    - _Requirements: 7.4, 14.3_
  - [ ] 15.2 Vérifier les labels et attributs ARIA des formulaires
    - Ajouter les labels explicites sur tous les champs
    - Ajouter aria-required, aria-invalid, aria-describedby
    - _Requirements: 14.4, 14.5_
  - [ ] 15.3 Vérifier le contraste et la taille du texte
    - S'assurer que le contraste est >= 4.5:1 sur fond noir
    - Vérifier que le texte de contenu est >= 16px
    - _Requirements: 14.1, 14.2_
  - [ ] 15.4 Écrire le test property-based pour le focus visible
    - **Property 8: Focus visible navigation clavier**
    - Parcourir tous les éléments interactifs
    - Vérifier la présence de styles :focus-visible
    - **Validates: Requirements 7.4, 14.3**
  - [ ] 15.5 Écrire le test property-based pour les labels ARIA
    - **Property 16: Labels et ARIA formulaires**
    - Parcourir tous les champs de formulaire
    - Vérifier la présence des labels et attributs ARIA
    - **Validates: Requirements 14.4, 14.5**
  - [ ] 15.6 Écrire le test property-based pour le contraste
    - **Property 14: Contraste accessibilité texte**
    - Analyser les combinaisons couleur texte/fond
    - Vérifier que le ratio de contraste est suffisant
    - **Validates: Requirements 14.1**
  - [ ] 15.7 Écrire le test property-based pour la taille du texte
    - **Property 15: Taille texte minimale**
    - Parcourir tous les éléments de texte
    - Vérifier que la taille est >= 16px pour le contenu
    - **Validates: Requirements 14.2**

- [ ] 16. Checkpoint - Vérifier Sécurité et Accessibilité
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 17. Intégration finale et documentation
  - [ ] 17.1 Créer les pages d'erreur personnalisées (404, 500)
    - Créer templates/errors/404.html avec design TUS
    - Créer templates/errors/500.html avec design TUS
    - Configurer les handlers dans urls.py
    - _Requirements: Error Handling_
  - [ ] 17.2 Créer les fixtures de données de démonstration
    - Créer 3-4 projets de démonstration
    - Créer les images placeholder
    - Créer la commande de management pour charger les fixtures
    - _Requirements: 3.1_
  - [ ] 17.3 Rédiger le README de déploiement
    - Documenter l'installation locale
    - Documenter le déploiement en production
    - Lister les variables d'environnement requises
    - _Requirements: 15.5_
  - [ ] 17.4 Configurer les settings de production
    - Configurer PostgreSQL
    - Configurer le backend email (Postmark/Brevo)
    - Configurer les fichiers statiques (whitenoise ou S3)
    - _Requirements: 15.4_

- [ ] 18. Checkpoint final - Validation complète
  - Ensure all tests pass, ask the user if questions arise.
  - Vérifier que toutes les pages sont accessibles et fonctionnelles
  - Vérifier que le formulaire de contact fonctionne de bout en bout
  - Vérifier que les téléchargements fonctionnent
  - Vérifier le responsive sur mobile

---

## Notes

- Tous les tests sont obligatoires pour garantir une couverture complète dès le départ
- Chaque tâche référence les requirements spécifiques pour la traçabilité
- Les checkpoints permettent de valider l'avancement incrémental
- Les tests property-based utilisent hypothesis avec 100 itérations minimum
- Le stack technique est fixé : Django 5.x + HTMX + Tailwind CSS + pytest + hypothesis
