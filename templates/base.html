{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no">
    <!-- View Transitions API -->
    <meta name="view-transition" content="same-origin">
    <title>{% block title %}Trait d'Union Studio{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}Agence web experte en ingénierie digitale en Guyane (Cayenne, Kourou, Saint-Laurent), Martinique et Guadeloupe.{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}agence web guyane, création site internet cayenne, site web guadeloupe, site web martinique, ingénierie web, développement web kourou{% endblock %}">
    <!-- OpenGraph tags -->
    <meta property="og:title" content="{% block og_title %}Trait d'Union Studio{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Studio de design et développement web de luxe technologique.{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{% static 'img/tus-logo.svg' %}{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:site_name" content="Trait d'Union Studio">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}Trait d'Union Studio{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Studio de design et développement web de luxe technologique.{% endblock %}">
    <!-- Schema.org JSON-LD Structured Data -->
    {% include 'partials/schema_org.html' %}
    <!-- Preload fonts for better LCP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'tus-black': '#07080A',
                        'tus-white': '#F6F7FB',
                        'tus-blue': '#0B2DFF',
                        'tus-green': '#22C55E',
                        'tus-green-light': '#4ADE80',
                        'surface-dark': '#0D1016',
                        'stroke-dark': 'rgba(246,247,251,0.10)',
                    },
                    fontFamily: {
                        'display': ['Space Grotesk', 'system-ui', 'sans-serif'],
                        'body': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out forwards',
                        'slide-up': 'slideUp 0.8s ease-out forwards',
                        'slide-in-right': 'slideInRight 0.6s ease-out forwards',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
                        'marquee': 'marquee 20s linear infinite',
                        'gradient-shift': 'gradientShift 3s ease-in-out infinite',
                        'text-scroll': 'textScroll 18s linear infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideInRight: {
                            '0%': { opacity: '0', transform: 'translateX(-20px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' },
                        },
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 20px rgba(11,45,255,0.3)' },
                            '50%': { boxShadow: '0 0 40px rgba(11,45,255,0.6)' },
                        },
                        marquee: {
                            '0%': { transform: 'translateX(0%)' },
                            '100%': { transform: 'translateX(-50%)' },
                        },
                        gradientShift: {
                            '0%, 100%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' },
                        },
                        textScroll: {
                            '0%': { transform: 'translateX(100%)' },
                            '100%': { transform: 'translateX(-100%)' },
                        },
                    },
                }
            }
        }
    </script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        /* Fix pour les options de select sur fond sombre */
        select option {
            background-color: #07080A;
            color: #F6F7FB;
            padding: 12px;
        }
        select option:hover,
        select option:focus,
        select option:checked {
            background-color: #0B2DFF;
            color: #F6F7FB;
        }
        /* Fix pour les navigateurs WebKit */
        select::-webkit-scrollbar {
            width: 8px;
        }
        select::-webkit-scrollbar-track {
            background: #0D1016;
        }
        select::-webkit-scrollbar-thumb {
            background: rgba(11,45,255,0.5);
            border-radius: 4px;
        }
        
        /* ============================================
           VIEW TRANSITIONS - Apple-like smoothness
           ============================================ */
        @view-transition {
            navigation: auto;
        }
        
        /* Transition de la page entière */
        ::view-transition-old(root) {
            animation: fade-out 0.25s ease-out forwards;
        }
        ::view-transition-new(root) {
            animation: fade-in 0.35s ease-out forwards;
        }
        
        /* Transitions personnalisées pour le contenu principal */
        ::view-transition-old(main-content) {
            animation: slide-out-left 0.3s ease-in-out forwards;
        }
        ::view-transition-new(main-content) {
            animation: slide-in-right 0.3s ease-in-out forwards;
        }
        
        /* Navbar reste fixe pendant les transitions */
        ::view-transition-group(navbar) {
            animation: none;
        }
        
        @keyframes fade-out {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slide-out-left {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(-20px); }
        }
        @keyframes slide-in-right {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* ============================================
           MICRO-INTERACTIONS
           ============================================ */
        /* Boutons avec feedback tactile */
        .btn-primary {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(11, 45, 255, 0.4);
        }
        .btn-primary:active {
            transform: translateY(0) scale(0.98);
        }
        
        /* Links avec underline animé */
        .link-animated {
            position: relative;
        }
        .link-animated::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #0B2DFF, #00D4FF);
            transition: width 0.3s ease;
        }
        .link-animated:hover::after {
            width: 100%;
        }
        
        /* Cards avec effet de profondeur */
        .card-interactive {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card-interactive:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        /* Focus states accessibles et élégants */
        :focus-visible {
            outline: 2px solid #0B2DFF;
            outline-offset: 3px;
            border-radius: 4px;
        }
        
        /* Smooth scroll */
        html {
            scroll-behavior: smooth;
        }
        
        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, ::before, ::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            html {
                scroll-behavior: auto;
            }
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-tus-black text-tus-white font-body antialiased">
    {% include 'partials/navbar.html' %}
    <main class="min-h-screen" style="view-transition-name: main-content;">
        {% block content %}{% endblock %}
    </main>
    {% include 'partials/footer.html' %}
    <!-- Alpine.js for micro-interactions -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- HTMX with View Transitions support -->
    <script src="https://unpkg.com/htmx.org@2.0.0"></script>
    <script>
        // ============================================
        // HTMX Configuration - Simplified
        // ============================================
        
        // Only enable boost for specific elements, not globally
        // This prevents issues with full page navigation
        
        // Loading indicator for HTMX requests
        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            document.body.classList.add('htmx-request');
            const target = evt.detail.elt;
            if (target.tagName === 'A' || target.tagName === 'BUTTON') {
                target.style.opacity = '0.7';
                target.style.pointerEvents = 'none';
            }
        });
        
        document.body.addEventListener('htmx:afterRequest', function(evt) {
            document.body.classList.remove('htmx-request');
            evt.detail.elt.style.opacity = '';
            evt.detail.elt.style.pointerEvents = '';
        });
        
        // ============================================
        // MICRO-INTERACTIONS
        // ============================================
        
        // Magnetic buttons effect (Apple-like)
        document.querySelectorAll('.btn-magnetic').forEach(btn => {
            btn.addEventListener('mousemove', (e) => {
                const rect = btn.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                btn.style.transform = `translate(${x * 0.1}px, ${y * 0.1}px)`;
            });
            btn.addEventListener('mouseleave', () => {
                btn.style.transform = 'translate(0, 0)';
            });
        });
        
        // Smooth scroll to anchors
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // ============================================
        // APPLE-LIKE SCROLL REVEAL
        // ============================================
        const revealElements = document.querySelectorAll('.reveal, .reveal-scale, .reveal-left, .reveal-right');
        
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        });

        revealElements.forEach(el => revealObserver.observe(el));

        // ============================================
        // NAVBAR SCROLL EFFECT
        // ============================================
        const navbar = document.getElementById('navbar');
        let lastScroll = 0;

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
            
            lastScroll = currentScroll;
        }, { passive: true });

        // ============================================
        // CUSTOM CURSOR (Desktop only)
        // ============================================
        if (window.matchMedia('(hover: hover)').matches) {
            const cursorDot = document.createElement('div');
            const cursorRing = document.createElement('div');
            cursorDot.className = 'cursor-dot';
            cursorRing.className = 'cursor-ring';
            document.body.appendChild(cursorDot);
            document.body.appendChild(cursorRing);

            let mouseX = 0, mouseY = 0;
            let ringX = 0, ringY = 0;

            document.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                cursorDot.style.left = mouseX + 'px';
                cursorDot.style.top = mouseY + 'px';
            });

            // Smooth ring follow
            function animateRing() {
                ringX += (mouseX - ringX) * 0.15;
                ringY += (mouseY - ringY) * 0.15;
                cursorRing.style.left = ringX + 'px';
                cursorRing.style.top = ringY + 'px';
                requestAnimationFrame(animateRing);
            }
            animateRing();

            // Hover effect on interactive elements
            const hoverTargets = document.querySelectorAll('a, button, .card-premium, .bento-item, input, textarea, select');
            hoverTargets.forEach(el => {
                el.addEventListener('mouseenter', () => cursorRing.classList.add('hover'));
                el.addEventListener('mouseleave', () => cursorRing.classList.remove('hover'));
            });
        }

        // ============================================
        // BENTO CARD MOUSE GLOW EFFECT
        // ============================================
        document.querySelectorAll('.bento-item').forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 100;
                const y = ((e.clientY - rect.top) / rect.height) * 100;
                card.style.setProperty('--mouse-x', x + '%');
                card.style.setProperty('--mouse-y', y + '%');
            });
        });

        // ============================================
        // NUMBER COUNTER ANIMATION
        // ============================================
        const counters = document.querySelectorAll('.counter');
        const counterObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.dataset.counted) {
                    entry.target.dataset.counted = 'true';
                    const target = parseInt(entry.target.dataset.target);
                    const suffix = entry.target.dataset.suffix || '';
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            entry.target.textContent = target + suffix;
                            clearInterval(timer);
                        } else {
                            entry.target.textContent = Math.floor(current) + suffix;
                        }
                    }, 30);
                }
            });
        }, { threshold: 0.5 });

        counters.forEach(c => counterObserver.observe(c));
    </script>
    {% block extra_js %}{% endblock %}
    
    <!-- RGPD Cookie Consent Banner -->
    {% include 'partials/cookie_consent.html' %}
</body>
</html>
