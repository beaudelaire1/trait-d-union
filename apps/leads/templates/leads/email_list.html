{% extends "base.html" %}
{% load static %}

{% block title %}Mes emails - Trait d'Union Studio{% endblock %}

{% block content %}
<div class="min-h-screen bg-tus-black text-tus-white py-12 px-4 sm:px-6 lg:px-8">
    <!-- Background blobs -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-40 -right-40 w-[600px] h-[600px] bg-tus-blue/15 rounded-full blur-[150px]"></div>
        <div class="absolute -bottom-40 -left-40 w-[600px] h-[600px] bg-tus-green/10 rounded-full blur-[150px]"></div>
    </div>

    <div class="relative max-w-6xl mx-auto">
        <!-- Header -->
        <div class="mb-8 animate-fade-in flex flex-col md:flex-row md:items-center md:justify-between">
            <div>
                <h1 class="text-4xl md:text-5xl font-display font-bold text-tus-white mb-3">
                    üì¨ Mes emails
                </h1>
                <p class="text-tus-white/70 text-lg">
                    G√©rez vos emails professionnels
                </p>
            </div>
            <a href="{% url 'leads:email_compose' %}" class="mt-4 md:mt-0 inline-flex items-center justify-center bg-tus-blue text-tus-white font-display font-semibold px-6 py-3 rounded-xl hover:bg-tus-blue/90 hover:scale-[1.02] active:scale-[0.98] transition-all duration-300 shadow-lg shadow-tus-blue/20">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                Composer un email
            </a>
        </div>

        {% if emails %}
        <!-- Emails grid -->
        <div class="grid gap-4 animate-slide-up">
            {% for email in emails %}
            <a href="{% url 'leads:email_detail' email.pk %}" class="group bg-tus-white/5 backdrop-blur-sm border border-tus-white/10 rounded-2xl p-6 hover:bg-tus-white/[0.07] hover:border-tus-blue/30 transition-all duration-300">
                <div class="flex items-start justify-between">
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-3 mb-2">
                            {% if email.is_draft %}
                            <span class="inline-flex items-center px-3 py-1 bg-tus-white/10 text-tus-white/70 text-xs font-display font-semibold rounded-full">
                                üìù Brouillon
                            </span>
                            {% else %}
                            <span class="inline-flex items-center px-3 py-1 bg-tus-green/10 text-tus-green text-xs font-display font-semibold rounded-full">
                                ‚úì Envoy√©
                            </span>
                            {% endif %}
                            <span class="text-tus-white/40 text-sm">
                                {{ email.created_at|date:"d/m/Y √† H:i" }}
                            </span>
                        </div>
                        
                        <h3 class="text-tus-white font-display font-semibold text-lg mb-2 truncate group-hover:text-tus-blue transition-colors">
                            {{ email.subject }}
                        </h3>
                        
                        <div class="flex items-center text-tus-white/60 text-sm">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            √Ä: {{ email.to_emails|truncatewords:5 }}
                        </div>
                    </div>
                    
                    <svg class="w-5 h-5 text-tus-white/40 group-hover:text-tus-blue group-hover:translate-x-1 transition-all flex-shrink-0 ml-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </div>
            </a>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if is_paginated %}
        <div class="mt-8 flex justify-center gap-2">
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}" class="px-4 py-2 bg-tus-white/5 border border-tus-white/10 rounded-lg text-tus-white hover:bg-tus-white/10 transition-all">
                Pr√©c√©dent
            </a>
            {% endif %}
            
            <span class="px-4 py-2 bg-tus-blue/20 border border-tus-blue/30 rounded-lg text-tus-white">
                Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}
            </span>
            
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" class="px-4 py-2 bg-tus-white/5 border border-tus-white/10 rounded-lg text-tus-white hover:bg-tus-white/10 transition-all">
                Suivant
            </a>
            {% endif %}
        </div>
        {% endif %}
        
        {% else %}
        <!-- Empty state -->
        <div class="bg-tus-white/5 backdrop-blur-sm border border-tus-white/10 rounded-2xl p-12 text-center animate-slide-up">
            <div class="text-6xl mb-4">üì≠</div>
            <h3 class="text-tus-white font-display font-semibold text-2xl mb-2">
                Aucun email pour le moment
            </h3>
            <p class="text-tus-white/60 mb-6">
                Commencez par composer votre premier email professionnel
            </p>
            <a href="{% url 'leads:email_compose' %}" class="inline-flex items-center justify-center bg-tus-blue text-tus-white font-display font-semibold px-6 py-3 rounded-xl hover:bg-tus-blue/90 hover:scale-[1.02] active:scale-[0.98] transition-all duration-300">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                Composer un email
            </a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
