{% extends 'base.html' %}
{% load static %}

{% block title %}Mes projets - Espace Client | Trait d'Union Studio{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/client-portal.css' %}">
{% endblock %}

{% block content %}
<div class="client-portal" x-data="{ sidebarOpen: true }">
    {% include 'clients/partials/sidebar.html' %}

    <!-- Main Content -->
    <main class="client-main">
        <header class="client-header">
            <div class="header-content">
                <div>
                    <nav class="breadcrumb">
                        <a href="{% url 'clients:dashboard' %}">Tableau de bord</a>
                        <span>/</span>
                        <span>Projets</span>
                    </nav>
                    <h1>Mes projets</h1>
                </div>
            </div>
        </header>

        <div class="client-content">
            {% if projects %}
            <div class="projects-grid">
                {% for project in projects %}
                <a href="{% url 'clients:project_detail' project.pk %}" class="project-card">
                    <div class="project-card-header">
                        <span class="status-badge status-{{ project.status }}">{{ project.get_status_display }}</span>
                        <span class="project-progress">{{ project.progress }}%</span>
                    </div>
                    <h3>{{ project.name }}</h3>
                    {% if project.description %}
                    <p class="project-desc">{{ project.description|truncatewords:20 }}</p>
                    {% endif %}
                    <div class="project-card-footer">
                        {% if project.estimated_delivery %}
                        <span class="project-date">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            {{ project.estimated_delivery|date:"d/m/Y" }}
                        </span>
                        {% endif %}
                        <span class="project-arrow">→</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ project.progress }}%"></div>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
                <h2>Aucun projet pour le moment</h2>
                <p>Vos projets apparaîtront ici une fois qu'un devis sera accepté.</p>
                <a href="{% url 'clients:new_request' %}" class="btn-primary">Demander un devis</a>
            </div>
            {% endif %}
        </div>
    </main>
</div>
{% endblock %}
